<!doctype html>
<html lang="si">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AnyCash.lk — Loan (Single File)</title>
<style>
  :root{
    --accent:#0b74de;
    --bg:#f7f9fb;
    --card:#ffffff;
    --text:#111827;
    --muted:#6b7280;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family:Inter, Roboto, "Noto Sans Sinhala", Arial, sans-serif;
    background:linear-gradient(180deg,#eef6ff 0%,var(--bg) 100%);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
  }
  .wrap{max-width:980px;margin:18px auto;padding:16px}
  .card{
    background:var(--card);
    border-radius:12px;
    padding:18px;
    box-shadow:0 6px 18px rgba(15,23,42,0.06);
  }
  .header{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:54px;height:54px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#06b6d4);display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:20px}
  .langswitch{display:flex;gap:8px;align-items:center}
  .lang-btn{border:1px solid transparent;padding:8px 10px;border-radius:8px;background:transparent;cursor:pointer}
  .lang-btn.active{background:var(--accent);color:white;border-color:rgba(0,0,0,0.04)}
  .main{display:flex;gap:18px;align-items:flex-start;justify-content:space-between}
  .left,.right{flex:1}
  .right{max-width:360px}
  h1{font-size:20px;margin:6px 0 12px}
  .small{font-size:13px;color:var(--muted)}
  .slider-wrap{padding:12px 8px}
  .amount-val{font-size:28px;font-weight:700;margin:8px 0}
  .range-input{width:100%}
  .apply-btn{display:inline-block;padding:12px 18px;border-radius:10px;background:var(--accent);color:white;text-decoration:none;font-weight:600;border:none;cursor:pointer}
  .code-row{margin-top:12px}
  .input,.inline-input{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef8;background:#fbfdff}
  .inline-row{display:flex;gap:8px}
  .inline-row .inline-input{flex:1}
  .info{background:#f8fafc;border-radius:10px;padding:12px;margin-top:12px;color:var(--muted)}
  footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
  .secondary-card{background:linear-gradient(180deg,#ffffff,#fbfdff);padding:14px;border-radius:10px}
  .hidden{display:none}
  /* second page */
  .page{display:none}
  .page.active{display:block}
  .back-btn{background:#eef2ff;border:none;padding:8px 10px;border-radius:8px;cursor:pointer}
  .big-num{font-size:32px;font-weight:800}
  .summary-row{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
  /* responsive */
  @media (max-width:720px){
    .wrap{padding:8px;margin:0}
    .main{flex-direction:column}
    .right{max-width:100%}
    .logo{width:48px;height:48px}
    body{background:var(--bg)}
    .card{border-radius:0;min-height:100vh;padding:16px}
    footer{position:fixed;bottom:0;left:0;right:0;padding:12px;background:transparent}
  }
</style>
</head>
<body>
<div class="wrap">

  <!-- PAGE: main -->
  <div id="page-main" class="page active card">
    <div class="header">
      <div class="brand">
        <div class="logo">AC</div>
        <div>
          <div id="brandTitle">AnyCash.lk</div>
          <div class="small" id="brandSubtitle">ඉක්මන් සහ සරල ණය</div>
        </div>
      </div>

      <div class="langswitch" aria-hidden="false">
        <button class="lang-btn active" data-lang="si" id="btn-si">සිංහල</button>
        <button class="lang-btn" data-lang="en" id="btn-en">English</button>
      </div>
    </div>

    <div class="main">
      <div class="left">
        <h1 id="lead">ඔබට අවශ්‍ය මුදල තෝරන්න</h1>

        <div class="slider-wrap">
          <div class="small" id="minmax">රු.5,000 — රු.600,000</div>
          <div class="amount-val" id="amountDisplay">රු.50,000</div>

          <input id="amountRange" class="range-input" type="range" min="5000" max="600000" step="1000" value="50000">

          <div class="info" id="termInfo">අදාල කාල පරාසය: <strong id="termText">12 මාස</strong></div>

          <div style="margin-top:12px">
            <div class="small" id="enterCodeLabel">Promo / Referral Code (optional)</div>
            <div class="inline-row code-row">
              <input id="codeInput" class="inline-input" placeholder="Enter code (optional)">
              <button id="goApply" class="apply-btn">Apply</button>
            </div>
            <div class="small" style="margin-top:8px" id="noteText">Apply බොත්තම ඔබන්න — දෙවැනි පිටුවේ ගෙවීමේ විස්තර දර්ශනය වේ.</div>
          </div>
        </div>

      </div>

      <div class="right">
        <div class="secondary-card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="small" id="summaryTitle">Loan Summary</div>
              <div id="summarySubtitle" class="small">Interest rate: 8% p.a.</div>
            </div>
            <div style="text-align:right">
              <div class="small">Selected</div>
              <div id="summaryAmount" style="font-weight:700">රු.50,000</div>
            </div>
          </div>

          <div style="margin-top:12px" id="calcPreview">
            <div class="small" id="estLabel">Estimated monthly</div>
            <div style="font-size:22px;font-weight:700" id="monthlyPreview">රු.4,400</div>
            <div class="small" id="totalPreview">Total to pay: රු.52,800</div>
          </div>

          <div style="margin-top:14px" class="small">
            <strong>Note:</strong> මේක estimator එකක්. Apply කිරීමට Apply බොත්තම ඔබන්න.
          </div>
        </div>
      </div>
    </div>

    <footer>
      <div class="small">AnyCash.lk • © <span id="year"></span></div>
    </footer>
  </div>

  <!-- PAGE: apply / second -->
  <div id="page-apply" class="page card" aria-hidden="true">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <button id="backBtn" class="back-btn">&larr; <span id="backText">Back</span></button>
      </div>
      <div style="text-align:right">
        <div id="applyTitle" style="font-weight:700">Apply — Payment Details</div>
        <div class="small" id="applySubtitle">Interest rate: 8% p.a.</div>
      </div>
    </div>

    <div style="margin-top:18px">
      <div class="small">Selected amount</div>
      <div class="big-num" id="applyAmount">රු.50,000</div>

      <div class="summary-row">
        <div>
          <div class="small">Term</div>
          <div id="applyTerm" style="font-weight:700">12 months</div>
        </div>

        <div>
          <div class="small">Monthly installment</div>
          <div id="applyMonthly" style="font-weight:700">රු.4,400</div>
        </div>

        <div>
          <div class="small">Total to pay</div>
          <div id="applyTotal" style="font-weight:700">රු.52,800</div>
        </div>
      </div>

      <div style="margin-top:14px" class="info">
        <div class="small"><strong>පොලී අනුපාතය:</strong> 8% p.a.</div>
        <div style="margin-top:8px" id="applyCodeRow"><strong>Code:</strong> <span id="applyCode">—</span></div>
      </div>

      <div style="margin-top:18px">
        <button id="confirmBtn" class="apply-btn">Confirm & Proceed</button>
      </div>
    </div>
  </div>

</div>

<script>
/* ========== Settings & Texts ========== */
const ANNUAL_RATE = 8.0; // percent p.a.

/* localization */
const TEXTS = {
  si: {
    brandSubtitle: "ඉක්මන් සහ සරල ණය",
    lead: "ඔබට අවශ්‍ය මුදල තෝරන්න",
    minmax: "රු.5,000 — රු.600,000",
    termInfo: "අදාල කාල පරාසය:",
    enterCodeLabel: "Promo / Referral Code (optional)",
    applyBtn: "Apply",
    noteText: "Apply බොත්තම ඔබන්න — දෙවැනි පිටුවේ ගෙවීමේ විස්තර දර්ශනය වේ.",
    summaryTitle: "Loan Summary",
    summarySubtitle: "Interest rate: 8% p.a.",
    estLabel: "Estimated monthly",
    backText: "පසුට",
    applyTitle: "Apply — ගෙවීම් විස්තර",
    applySubtitle: "පොලී අනුපාතය: 8% p.a.",
    confirmBtn: "තහවුරු කරන්න",
    selected: "තෝරාගත්",
    termMonths: (n)=> ${n} මාස,
    totalToPay: (v)=> මුළු ගෙවිය යුතු මුදල: ${formatRupee(v)}
  },
  en: {
    brandSubtitle: "Fast & simple loans",
    lead: "Choose the amount you need",
    minmax: "LKR 5,000 — LKR 600,000",
    termInfo: "Term:",
    enterCodeLabel: "Promo / Referral Code (optional)",
    applyBtn: "Apply",
    noteText: "Click Apply — you'll see payment details on next page.",
    summaryTitle: "Loan Summary",
    summarySubtitle: "Interest rate: 8% p.a.",
    estLabel: "Estimated monthly",
    backText: "Back",
    applyTitle: "Apply — Payment Details",
    applySubtitle: "Interest rate: 8% p.a.",
    confirmBtn: "Confirm & Proceed",
    selected: "Selected",
    termMonths: (n)=> ${n} months,
    totalToPay: (v)=> Total to pay: ${formatRupee(v)}
  }
};

/* ========== Helpers ========== */
function formatRupee(v){
  // format integer/float as "රු.X,XXX" when lang=si, or "LKR X,XXX" for en
  const n = Math.round(v);
  const s = n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  return (currentLang === 'si') ? රු.${s} : LKR ${s};
}

/* determine term (months) according to mapping described earlier */
function determineTerm(amount){
  // Use mapping from user's specification (best-effort):
  // - amount == 5000 => 12 months
  // - amount == 50000 => 5 months
  // - 6000 <= amount <= 50000 => 12 months
  // - 60000 <= amount <= 150000 => 12 months
  // - 150001 <= amount <= 300000 => 24 months
  // - 300001 <= amount <= 600000 => 30 months
  // default 12
  const a = Number(amount);
  if(a === 5000) return 12;
  if(a === 50000) return 5;
  if(a >= 6000 && a <= 50000) return 12;
  if(a >= 60000 && a <= 150000) return 12;
  if(a > 150000 && a <= 300000) return 24;
  if(a > 300000 && a <= 600000) return 30;
  return 12;
}

/* amortized monthly payment */
function monthlyPayment(principal, annualRatePercent, months){
  const P = Number(principal);
  const r = (annualRatePercent/100)/12; // monthly rate
  const n = Number(months);
  if(r === 0) return P / n;
  const numerator = P * r * Math.pow(1 + r, n);
  const denom = Math.pow(1 + r, n) - 1;
  return numerator / denom;
}

/* ========== UI wiring ========== */
let currentLang = 'si'; // default Sinhala

const el = id => document.getElementById(id);
const amountRange = el('amountRange');
const amountDisplay = el('amountDisplay');
const termText = el('termText');
const summaryAmount = el('summaryAmount');
const monthlyPreview = el('monthlyPreview');
const totalPreview = el('totalPreview');
const codeInput = el('codeInput');
const goApply = el('goApply');

const btnSi = el('btn-si');
const btnEn = el('btn-en');

const pageMain = el('page-main');
const pageApply = el('page-apply');
const backBtn = el('backBtn');
const applyAmount = el('applyAmount');
const applyTerm = el('applyTerm');
const applyMonthly = el('applyMonthly');
const applyTotal = el('applyTotal');
const applyCode = el('applyCode');
const applyTitle = el('applyTitle');
const applySubtitle = el('applySubtitle');
const yearEl = el('year');

/* initialize */
yearEl.textContent = new Date().getFullYear();

function refreshAll(){
  const amt = Number(amountRange.value);
  // update displays
  amountDisplay.textContent = formatRupee(amt);
  summaryAmount.textContent = formatRupee(amt);

  const term = determineTerm(amt);
  termText.textContent = TEXTS[currentLang].termMonths(term);

  // calc
  const monthly = monthlyPayment(amt, ANNUAL_RATE, term);
  const total = monthly * term;

  monthlyPreview.textContent = formatRupee(monthly);
  totalPreview.textContent = TEXTS[currentLang].totalToPay(total);

  // Apply page preview
  applyAmount.textContent = formatRupee(amt);
  applyTerm.textContent = TEXTS[currentLang].termMonths(term);
  applyMonthly.textContent = formatRupee(monthly);
  applyTotal.textContent = formatRupee(total);
  applyCode.textContent = codeInput.value ? codeInput.value : '—';

  // localization of a few strings
  el('brandSubtitle').textContent = TEXTS[currentLang].brandSubtitle;
  el('lead').textContent = TEXTS[currentLang].lead;
  el('minmax').textContent = TEXTS[currentLang].minmax;
  el('enterCodeLabel').textContent = TEXTS[currentLang].enterCodeLabel;
  el('noteText').textContent = TEXTS[currentLang].noteText;
  el('summaryTitle').textContent = TEXTS[currentLang].summaryTitle;
  el('summarySubtitle').textContent = TEXTS[currentLang].summarySubtitle;
  el('estLabel').textContent = TEXTS[currentLang].estLabel;
  el('backText').textContent = TEXTS[currentLang].backText;
  applyTitle.textContent = TEXTS[currentLang].applyTitle;
  applySubtitle.textContent = TEXTS[currentLang].applySubtitle;
  el('confirmBtn')?.setAttribute('title', TEXTS[currentLang].confirmBtn);
}

/* events */
amountRange.addEventListener('input', ()=>{
  refreshAll();
});

goApply.addEventListener('click', ()=>{
  // show apply page (single-file navigation)
  pageMain.classList.remove('active'); pageMain.setAttribute('aria-hidden','true');
  pageApply.classList.add('active'); pageApply.setAttribute('aria-hidden','false');
  // ensure latest values
  refreshAll();
});

backBtn.addEventListener('click', ()=>{
  pageApply.classList.remove('active'); pageApply.setAttribute('aria-hidden','true');
  pageMain.classList.add('active'); pageMain.setAttribute('aria-hidden','false');
});

btnSi.addEventListener('click', ()=>{
  currentLang = 'si';
  btnSi.classList.add('active'); btnEn.classList.remove('active');
  refreshAll();
});
btnEn.addEventListener('click', ()=>{
  currentLang = 'en';
  btnEn.classList.add('active'); btnSi.classList.remove('active');
  refreshAll();
});

/* Confirm button (placeholder) */
el('confirmBtn').addEventListener('click', ()=>{
  // For demo: just alert summary (could be replaced with actual submission)
  const amt = Number(amountRange.value);
  const term = determineTerm(amt);
  const monthly = monthlyPayment(amt, ANNUAL_RATE, term);
  const total = monthly * term;
  alert((currentLang==='si'?
    ඔබ තෝරා ඇති මුදල: ${formatRupee(amt)}\nවිකල්පය: ${TEXTS[currentLang].termMonths(term)}\nමාසික වාරිකය: ${formatRupee(monthly)}\nමුළු ගෙවිය යුතු මුදල: ${formatRupee(total)}\n\nඔබගේ apply ඉදිරිපත් කිරීම සඳහා අපව දැන් අමතන්න. :
    Selected amount: ${formatRupee(amt)}\nTerm: ${TEXTS[currentLang].termMonths(term)}\nMonthly: ${formatRupee(monthly)}\nTotal to pay: ${formatRupee(total)}\n\nTo proceed, please contact us.));
});

/* code input update apply page live */
codeInput.addEventListener('input', ()=>{
  applyCode.textContent = codeInput.value ? codeInput.value : '—';
});

/* initial render */
refreshAll();
</script>
</body>
</html>
